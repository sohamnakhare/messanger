<br />
<br />
<div class="row">
	<div class="col-lg-4 col-md-6 col-md-offset-3 col-lg-offset-4">
		<div class="section">
			<div class="padding" style="padding-top:25px">
				<div data-jc="pictureupload" data-jc-path="settings.picture"
				data-width="150" data-height="150" data-url="/api/upload/photo/" class="auto center"
				data-path="" data-error-large="@(The picture is too large.)"></div>
				<div class="center mt10 b black" data-b="settings.name" data-b-html="n => n"></div>
			</div>
			<hr class="nmb nmt" />
			<div class="success hidden" data-b="settings.response" data-b-visible="n => n && n.success">
				<i class="fa fa-check-circle"></i>@(Your account has been updated successfully.)
			</div>
			<div class="padding">
				<div data-jc="textbox" data-jc-path="settings.name" data-maxlength="30" class="m" data-required="true">@(Your name)</div>
				<div data-jc="textbox" data-jc-path="settings.email" data-maxlength="120" class="m" data-required="true" data-jc-type="email">@(E-mail address)</div>
				<div data-jc="textbox" data-jc-path="settings.citizenship" data-maxlength="120" class="m">@(Citizenship)</div>
				<div data-jc="textbox" data-jc-path="settings.currentLocation" data-maxlength="120" class="m">@(Current Location)</div>
				<div data-jc="dropdown" data-jc-path="settings.currentJob"
					data-options="@(Working traditional 9-5)|Working traditional 9-5;@(Digital nomad)|Digital nomad;@(Doing a remote job)|Doing a remote job;@(Remote Entrepreneur)|Remote Entrepreneur;@(Co-founder)|Co-founder;@(Running online business)|Running online business;@(Other)|Other"
					class="m">@(I'm currently)</div>
				<div data-jc="dropdown" data-jc-path="settings.lookingFor"
					data-options="@(Freelance Project)|Freelance Project;@(Remote job)|Remote job;@(Nomad dating)|Nomad dating;@(Investing)|Investing;@(co-founder)|co-founder;@(co-rent)|co-rent;@(apartment)| apartment;@(to startup)|to startup;@(start online business)|start online business;@(start drop-shipping)|start drop-shipping;@(Language teacher job)|Language teacher job;@(Other)|Other"
					class="m">@(I'm looking for)</div>
				<div data-jc="dropdown" data-jc-path="settings.education"
					data-options="@(Masters)|Masters;@(Bachelors)|Bachelors;@(Some diploma)|Some diploma;@(Highschool)|Highschool;@(Other)|Other"
					class="m">@(Education)</div>
					<div data-jc="textbox" data-jc-path="settings.age" data-maxlength="120" class="m">@(Age)</div>
				<br />
				<div data-jc="error" data-jc-path="settings.response"></div>
				<div data-jc="validation" data-jc-path="settings">
					<button class="button exec" data-exec="settings_save" disabled="disabled">@(SUBMIT)</button>
				</div>
			</div>
		</div>
	</div>
</div>
<br />
<br />

<script>

	var settings = {};

	function settings_reload() {
		SET('current.title', '@(Settings)');
		SET('current.description', '@(Change your preferences)');
		$('#messagebox').addClass('hidden');
		EMIT('resize');
		var data = CLONE(user);
		if (!data.theme)
			data.theme = 'dark';
		SET('settings', data, true);
		SET('common.stats', null);
		SETTER('loading', 'hide', 1000);
	}

	WATCH('settings.theme', function(path, value, type) {
		type === 2 && settings_theme(value);
	});

	function settings_theme(value) {
		var body = $(document.body);
		body.attr('class').split(' ').forEach(function(item) {
			if (item.substring(0, 5) === 'theme')
				body.removeClass(item);
		});
		body.addClass('theme-' + value);
	}

	function settings_save() {
		if (BLOCKED('settings', 2000) || !MAIN.valid('settings.*'))
			return;
		RESET('settings.*');
		AJAX('POST /api/account/', settings, 'settings.response');
		user.name = settings.name;
		user.email = settings.email;
		user.picture !== settings.picture && $('.user-name').find('img').attr('src', '/photos/{0}.jpg'.format(settings.picture));
		user.picture = settings.picture;
		user.status = settings.status;
		user.theme = settings.theme;
		user.citizenship = settings.citizenship;
		user.currentJob = settings.currentJobs;
		user.currentLocation = settings.currentLocation;
		user.lookingFor = settings.lookingFor;
		user.education = settings.education;
		user.age = settings.age;
		var tmp = current.users.findItem('id', user.id);
		if (tmp) {
			tmp.status = user.status;
			tmp.name = user.name;
			tmp.email = user.email;
			tmp.picture = user.picture;
			tmp.theme = user.theme;
		}
		settings_theme(user.theme);
	}

</script>